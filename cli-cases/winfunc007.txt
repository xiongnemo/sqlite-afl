.open --hexdb
| size 12288 pagesize 4096 filename winfunc007.txt.db
| page 1 offset 0
|      0: 53 51 4c 69 74 65 20 66 6f 72 6d 61 74 20 33 00   SQLite format 3.
|     16: 10 00 01 01 00 40 20 20 00 00 00 00 00 00 00 03   .....@  ........
|     32: 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 04   ................
|     48: 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00   ................
|     96: 00 00 00 00 0d 00 00 00 02 0f 87 00 0f d6 0f 87   ................
|   3968: 00 00 00 00 00 00 00 4d 02 07 17 11 11 01 81 05   .......M........
|   3984: 74 61 62 6c 65 74 32 74 32 03 43 52 45 41 54 45   tablet2t2.CREATE
|   4000: 20 54 41 42 4c 45 20 74 32 28 61 2c 20 62 2c 20    TABLE t2(a, b, 
|   4016: 63 2c 20 50 52 49 4d 41 52 59 20 4b 45 59 28 61   c, PRIMARY KEY(a
|   4032: 2c 20 62 2c 20 63 29 29 20 57 49 54 48 4f 55 54   , b, c)) WITHOUT
|   4048: 20 52 4f 57 49 44 28 01 06 17 11 11 01 3d 74 61    ROWID(......=ta
|   4064: 62 6c 65 74 31 74 31 02 43 52 45 41 54 45 20 54   blet1t1.CREATE T
|   4080: 41 42 4c 45 20 74 31 28 61 2c 20 62 2c 20 63 29   ABLE t1(a, b, c)
| page 2 offset 4096
|      0: 0d 00 00 00 2b 0e 0f 00 0f f6 0f ea 0f de 0f d2   ....+...........
|     16: 0f c6 0f ba 0f ae 0f a2 0f 96 0f 8a 0f 80 0f 74   ...............t
|     32: 0f 68 0f 5c 0f 50 0f 44 0f 38 0f 2c 0f 20 0f 16   .h...P.D.8.,. ..
|     48: 0f 0a 0e fe 0e f2 0e e9 0e dd 0e d1 0e c5 0e b9   ................
|     64: 0e ad 0e a1 0e 95 0e 89 0e 7d 0e 71 0e 65 0e 59   ...........q.e.Y
|     80: 0e 4d 0e 41 0e 39 0e 2d 0e 21 0e 15 0e 0f 00 00   .M.A.9.-.!......
|   3584: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04   ................
|   3600: 2b 04 00 00 00 0a 2a 04 11 11 02 48 48 61 61 03   +.....*....HHaa.
|   3616: 16 0a 29 04 11 11 02 47 47 61 61 01 e0 0a 28 04   ..)....GGaa...(.
|   3632: 11 11 02 41 41 61 61 00 df 06 27 04 11 00 00 42   ...AAaa...'....B
|   3648: 42 0a 26 04 11 11 02 49 49 62 62 02 9f 0a 25 04   B.&....IIbb...%.
|   3664: 11 11 02 43 43 62 62 01 5a 0a 24 04 11 11 02 48   ...CCbb.Z.$....H
|   3680: 48 62 62 03 c3 0a 23 04 11 11 02 42 42 62 62 02   Hbb...#....BBbb.
|   3696: c1 0a 22 04 11 11 02 46 46 61 61 02 9e 0a 21 04   .......FFaa...!.
|   3712: 11 11 02 41 41 61 61 00 ef 0a 20 04 11 11 02 42   ...AAaa... ....B
|   3728: 42 62 62 02 79 0a 1f 04 11 11 02 49 49 61 61 02   Bbb.y......IIaa.
|   3744: 8c 0a 1e 04 11 11 02 49 49 62 62 00 fa 0a 1d 04   .......IIbb.....
|   3760: 11 11 02 49 49 61 61 01 8e 0a 1c 04 11 11 02 41   ...IIaa........A
|   3776: 41 62 62 02 3c 0a 1b 04 11 11 02 41 41 61 61 03   Abb.<......AAaa.
|   3792: 8f 0a 1a 04 11 11 02 42 42 61 61 01 9c 0a 19 04   .......BBaa.....
|   3808: 11 11 02 41 41 62 62 01 35 07 18 04 11 00 01 45   ...AAbb.5......E
|   3824: 45 71 0a 17 04 11 11 02 41 41 61 61 03 a6 0a 16   Eq......AAaa....
|   3840: 04 11 11 02 42 42 62 62 03 48 0a 15 04 11 11 02   ....BBbb.H......
|   3856: 4a 4a 61 61 00 ea 08 14 04 11 11 00 46 46 62 62   JJaa........FFbb
|   3872: 0a 13 04 11 11 02 4a 4a 62 62 01 62 0a 12 04 11   ......JJbb.b....
|   3888: 11 02 44 44 61 61 03 4d 0a 11 04 11 11 02 42 42   ..DDaa.M......BB
|   3904: 62 62 03 18 0a 10 04 11 11 02 48 48 61 61 03 d3   bb........HHaa..
|   3920: 0a 0f 04 11 11 02 42 42 61 61 02 94 0a 0e 04 11   ......BBaa......
|   3936: 11 02 47 47 62 62 03 aa 0a 0d 04 11 11 02 43 43   ..GGbb........CC
|   3952: 62 62 03 36 0a 0c 04 11 11 02 46 46 62 62 02 3e   bb.6......FFbb.>
|   3968: 08 0b 04 00 11 02 62 62 03 4c 0a 0a 04 11 11 02   ......bb.L......
|   3984: 49 49 62 62 01 a5 0a 09 04 11 11 02 47 47 62 62   IIbb........GGbb
|   4000: 03 a1 0a 08 04 11 11 02 4a 4a 61 61 03 83 0a 07   ........JJaa....
|   4016: 04 11 11 02 4a 4a 61 61 03 00 0a 06 04 11 11 02   ....JJaa........
|   4032: 46 46 62 62 03 66 0a 05 04 11 11 02 48 48 61 61   FFbb.f......HHaa
|   4048: 01 e0 0a 04 04 11 11 02 46 46 62 62 03 aa 0a 03   ........FFbb....
|   4064: 04 11 11 02 42 42 61 61 01 8f 0a 02 04 11 11 02   ....BBaa........
|   4080: 43 43 61 61 00 9e 08 01 04 00 11 02 62 62 01 63   CCaa........bb.c
| page 3 offset 8192
|      0: 0a 00 00 00 25 0e 69 00 0f f5 0f ea 0f df 0f d4   ....%.i.........
|     16: 0f c9 0f be 0f b3 0f a8 0f 9d 0f 92 0f 87 0f 7c   ...............|
|     32: 0f 71 0f 66 0f 5b 0f 50 0f 45 0f 3a 0f 2f 0f 24   .q.f.[.P.E.:./.$
|     48: 0f 19 0f 0e 0f 03 0e f8 0e ed 0e e2 0e d7 0e cc   ................
|     64: 0e c1 0e b6 0e ab 0e a0 0e 95 0e 8a 0e 7f 0e 74   ...............t
|     80: 0e 69 00 00 00 00 00 00 00 00 00 00 00 00 00 00   .i..............
|   3680: 00 00 00 00 00 00 00 00 00 0a 04 11 11 02 4a 4a   ..............JJ
|   3696: 62 62 01 62 0a 04 11 11 02 4a 4a 61 61 03 83 0a   bb.b.....JJaa...
|   3712: 04 11 11 02 4a 4a 61 61 03 00 0a 04 11 11 02 4a   ....JJaa.......J
|   3728: 4a 61 61 00 ea 0a 04 11 11 02 49 49 62 62 02 9f   Jaa.......IIbb..
|   3744: 0a 04 11 11 02 49 49 62 62 01 a5 0a 04 11 11 02   .....IIbb.......
|   3760: 49 49 62 62 00 fa 0a 04 11 11 02 49 49 61 61 02   IIbb.......IIaa.
|   3776: 8c 0a 04 11 11 02 49 49 61 61 01 8e 0a 04 11 11   ......IIaa......
|   3792: 02 48 48 62 62 03 c3 0a 04 11 11 02 48 48 61 61   .HHbb.......HHaa
|   3808: 03 d3 0a 04 11 11 02 48 48 61 61 03 16 0a 04 11   .......HHaa.....
|   3824: 11 02 48 48 61 61 01 e0 0a 04 11 11 02 47 47 62   ..HHaa.......GGb
|   3840: 62 03 aa 0a 04 11 11 02 47 47 62 62 03 a1 0a 04   b.......GGbb....
|   3856: 11 11 02 47 47 61 61 01 e0 0a 04 11 11 02 46 46   ...GGaa.......FF
|   3872: 62 62 03 aa 0a 04 11 11 02 46 46 62 62 03 66 0a   bb.......FFbb.f.
|   3888: 04 11 11 02 46 46 62 62 02 3e 0a 04 11 11 02 46   ....FFbb.>.....F
|   3904: 46 61 61 02 9e 0a 04 11 11 02 44 44 61 61 03 4d   Faa.......DDaa.M
|   3920: 0a 04 11 11 02 43 43 62 62 03 36 0a 04 11 11 02   .....CCbb.6.....
|   3936: 43 43 62 62 01 5a 0a 04 11 11 02 43 43 61 61 00   CCbb.Z.....CCaa.
|   3952: 9e 0a 04 11 11 02 42 42 62 62 03 48 0a 04 11 11   ......BBbb.H....
|   3968: 02 42 42 62 62 03 18 0a 04 11 11 02 42 42 62 62   .BBbb.......BBbb
|   3984: 02 c1 0a 04 11 11 02 42 42 62 62 02 79 0a 04 11   .......BBbb.y...
|   4000: 11 02 42 42 61 61 02 94 0a 04 11 11 02 42 42 61   ..BBaa.......BBa
|   4016: 61 01 9c 0a 04 11 11 02 42 42 61 61 01 8f 0a 04   a.......BBaa....
|   4032: 11 11 02 41 41 62 62 02 3c 0a 04 11 11 02 41 41   ...AAbb.<.....AA
|   4048: 62 62 01 35 0a 04 11 11 02 41 41 61 61 03 a6 0a   bb.5.....AAaa...
|   4064: 04 11 11 02 41 41 61 61 03 8f 0a 04 11 11 02 41   ....AAaa.......A
|   4080: 41 61 61 00 ef 0a 04 11 11 02 41 41 61 61 00 df   Aaa.......AAaa..
| end winfunc007.txt.db
.testctrl prng_seed 1 db
.testctrl internal_functions
SELECT row_number() OVER win1,
       sum(c) OVER win1,
       max(c) OVER win2,
       min(c) OVER win3 + first_value(c) OVER win3,
       count(a) OVER (ORDER BY b)
FROM t1
WINDOW 
  win1 AS (ORDER BY a GROUPS BETWEEN 4 PRECEDING AND 1 FOLLOWING EXCLUDE CURRENT ROW),
  win2 AS (PARTITION BY b ORDER BY a),
  win3 AS (win2 RANGE BETWEEN 5.2 PRECEDING AND 0.1 PRECEDING EXCLUDE TIES);

INSERT OR IGNORE INTO t2 SELECT 
       lead(a||b) OVER (ORDER BY c DESC RANGE BETWEEN 1 FOLLOWING AND 5 FOLLOWING EXCLUDE GROUP),
       ntile(44) OVER (PARTITION BY b ORDER BY a GROUPS BETWEEN 2 FOLLOWING AND 6 FOLLOWING),
       total(c) OVER (ORDER BY c RANGE BETWEEN 0.3 PRECEDING AND 10 FOLLOWING EXCLUDE NO OTHERS)
       FROM t1;

SELECT dense_rank() OVER win,
       rank() OVER win,
       percent_rank() OVER win,
       cume_dist() OVER win,
       lag(c, 3, 'abc') OVER win,
       last_value(b) OVER win,
       nth_value(a, c) OVER win,
       group_concat(a, '.') OVER win
FROM t2
WINDOW win2 AS (ORDER BY c),
       win AS (win2 GROUPS 5 PRECEDING EXCLUDE CURRENT ROW);

