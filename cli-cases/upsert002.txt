.open --hexdb
| size 12288 pagesize 4096 filename upsert002.txt.db
| page 1 offset 0
|      0: 53 51 4c 69 74 65 20 66 6f 72 6d 61 74 20 33 00   SQLite format 3.
|     16: 10 00 01 01 00 40 20 20 00 00 00 00 00 00 00 03   .....@  ........
|     32: 00 00 00 00 00 00 00 00 00 00 00 06 00 00 00 04   ................
|     48: 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00   ................
|     96: 00 00 00 00 0d 00 00 00 06 0c 56 00 0f b3 0f 76   ..........V....v
|    112: 0e ce 0e 28 0d 3e 0c 56 00 00 00 00 00 00 00 00   ...(.>.V........
|   3152: 00 00 00 00 00 00 81 65 06 07 1b 11 11 08 83 33   .......e.......3
|   3168: 74 72 69 67 67 65 72 72 34 74 31 43 52 45 41 54   triggerr4t1CREAT
|   3184: 45 20 54 52 49 47 47 45 52 20 72 34 20 41 46 54   E TRIGGER r4 AFT
|   3200: 45 52 20 55 50 44 41 54 45 20 4f 4e 20 74 31 20   ER UPDATE ON t1 
|   3216: 42 45 47 49 4e 0a 20 20 20 20 49 4e 53 45 52 54   BEGIN.    INSERT
|   3232: 20 49 4e 54 4f 20 72 65 63 6f 72 64 28 78 2c 79    INTO record(x,y
|   3248: 29 0a 20 20 20 20 20 20 20 20 56 41 4c 55 45 53   ).        VALUES
|   3264: 28 27 61 66 74 65 72 2d 75 70 64 61 74 65 27 2c   ('after-update',
|   3280: 70 72 69 6e 74 66 28 27 25 64 2c 25 64 2c 25 64   printf('%d,%d,%d
|   3296: 2f 25 64 2c 25 64 2c 25 64 27 2c 0a 20 20 20 20   /%d,%d,%d',.    
|   3312: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                   
|   3328: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                   
|   3344: 20 20 6f 6c 64 2e 61 2c 6f 6c 64 2e 62 2c 6f 6c     old.a,old.b,ol
|   3360: 64 2e 63 2c 6e 65 77 2e 61 2c 6e 65 77 2e 62 2c   d.c,new.a,new.b,
|   3376: 6e 65 77 2e 63 29 29 3b 0a 20 20 45 4e 44 81 67   new.c));.  END.g
|   3392: 05 07 1b 11 11 08 83 37 74 72 69 67 67 65 72 72   .......7triggerr
|   3408: 33 74 31 43 52 45 41 54 45 20 54 52 49 47 47 45   3t1CREATE TRIGGE
|   3424: 52 20 72 33 20 42 45 46 4f 52 45 20 55 50 44 41   R r3 BEFORE UPDA
|   3440: 54 45 20 4f 4e 20 74 31 20 42 45 47 49 4e 0a 20   TE ON t1 BEGIN. 
|   3456: 20 20 20 49 4e 53 45 52 54 20 49 4e 54 4f 20 72      INSERT INTO r
|   3472: 65 63 6f 72 64 28 78 2c 79 29 0a 20 20 20 20 20   ecord(x,y).     
|   3488: 20 20 20 56 41 4c 55 45 53 28 27 62 65 66 6f 72      VALUES('befor
|   3504: 65 2d 75 70 64 61 74 65 27 2c 70 72 69 6e 74 66   e-update',printf
|   3520: 28 27 25 64 2c 25 64 2c 25 64 2f 25 64 2c 25 64   ('%d,%d,%d/%d,%d
|   3536: 2c 25 64 27 2c 0a 20 20 20 20 20 20 20 20 20 20   ,%d',.          
|   3552: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                   
|   3568: 20 20 20 20 20 20 20 20 20 20 20 20 6f 6c 64 2e               old.
|   3584: 61 2c 6f 6c 64 2e 62 2c 6f 6c 64 2e 63 2c 6e 65   a,old.b,old.c,ne
|   3600: 77 2e 61 2c 6e 65 77 2e 62 2c 6e 65 77 2e 63 29   w.a,new.b,new.c)
|   3616: 29 3b 0a 20 20 45 4e 44 81 23 04 07 1b 11 11 08   );.  END.#......
|   3632: 82 2f 74 72 69 67 67 65 72 72 32 74 31 43 52 45   ./triggerr2t1CRE
|   3648: 41 54 45 20 54 52 49 47 47 45 52 20 72 32 20 41   ATE TRIGGER r2 A
|   3664: 46 54 45 52 20 49 4e 53 45 52 54 20 4f 4e 20 74   FTER INSERT ON t
|   3680: 31 20 42 45 47 49 4e 0a 20 20 20 20 49 4e 53 45   1 BEGIN.    INSE
|   3696: 52 54 20 49 4e 54 4f 20 72 65 63 6f 72 64 28 78   RT INTO record(x
|   3712: 2c 79 29 0a 20 20 20 20 20 20 20 20 56 41 4c 55   ,y).        VALU
|   3728: 45 53 28 27 61 66 74 65 72 2d 69 6e 73 65 72 74   ES('after-insert
|   3744: 27 2c 70 72 69 6e 74 66 28 27 25 64 2c 25 64 2c   ',printf('%d,%d,
|   3760: 25 64 27 2c 6e 65 77 2e 61 2c 6e 65 77 2e 62 2c   %d',new.a,new.b,
|   3776: 6e 65 77 2e 63 29 29 3b 0a 20 20 45 4e 44 81 25   new.c));.  END.%
|   3792: 03 07 1b 11 11 08 82 33 74 72 69 67 67 65 72 72   .......3triggerr
|   3808: 31 74 31 43 52 45 41 54 45 20 54 52 49 47 47 45   1t1CREATE TRIGGE
|   3824: 52 20 72 31 20 42 45 46 4f 52 45 20 49 4e 53 45   R r1 BEFORE INSE
|   3840: 52 54 20 4f 4e 20 74 31 20 42 45 47 49 4e 0a 20   RT ON t1 BEGIN. 
|   3856: 20 20 20 49 4e 53 45 52 54 20 49 4e 54 4f 20 72      INSERT INTO r
|   3872: 65 63 6f 72 64 28 78 2c 79 29 0a 20 20 20 20 20   ecord(x,y).     
|   3888: 20 20 20 56 41 4c 55 45 53 28 27 62 65 66 6f 72      VALUES('befor
|   3904: 65 2d 69 6e 73 65 72 74 27 2c 70 72 69 6e 74 66   e-insert',printf
|   3920: 28 27 25 64 2c 25 64 2c 25 64 27 2c 6e 65 77 2e   ('%d,%d,%d',new.
|   3936: 61 2c 6e 65 77 2e 62 2c 6e 65 77 2e 63 29 29 3b   a,new.b,new.c));
|   3952: 0a 20 20 45 4e 44 3b 02 06 17 19 19 01 53 74 61   .  END;......Sta
|   3968: 62 6c 65 72 65 63 6f 72 64 72 65 63 6f 72 64 03   blerecordrecord.
|   3984: 43 52 45 41 54 45 20 54 41 42 4c 45 20 72 65 63   CREATE TABLE rec
|   4000: 6f 72 64 28 78 20 54 45 58 54 2c 20 79 20 54 45   ord(x TEXT, y TE
|   4016: 58 54 29 4b 01 07 17 11 11 01 81 01 74 61 62 6c   XT)K........tabl
|   4032: 65 74 31 74 31 02 43 52 45 41 54 45 20 54 41 42   et1t1.CREATE TAB
|   4048: 4c 45 20 74 31 28 61 20 49 4e 54 45 47 45 52 20   LE t1(a INTEGER 
|   4064: 50 52 49 4d 41 52 59 20 4b 45 59 2c 20 62 20 69   PRIMARY KEY, b i
|   4080: 6e 74 2c 20 63 20 44 45 46 41 55 4c 54 20 30 29   nt, c DEFAULT 0)
| page 2 offset 4096
|      0: 0d 00 00 00 00 10 00 00 00 00 00 00 00 00 00 00   ................
| page 3 offset 8192
|      0: 0d 00 00 00 00 10 00 00 00 00 00 00 00 00 00 00   ................
| end upsert002.txt.db
.testctrl prng_seed 1 db
.testctrl internal_functions
INSERT INTO t1(a,b) VALUES(1,2);
DELETE FROM record;
INSERT INTO t1(a,b) VALUES(1,2)
ON CONFLICT(a) DO UPDATE SET c=t1.c+1;

